警告：发现无法解析的日期，已将其转换为NaT
==================================================
线性回归模型结果
==================================================
                            OLS Regression Results                            
==============================================================================
Dep. Variable:                 Y染色体浓度   R-squared:                       0.221
Model:                            OLS   Adj. R-squared:                  0.212
Method:                 Least Squares   F-statistic:                     23.31
Date:                Sun, 07 Sep 2025   Prob (F-statistic):           3.51e-35
Time:                        14:18:51   Log-Likelihood:                 1588.3
No. Observations:                 749   AIC:                            -3157.
Df Residuals:                     739   BIC:                            -3110.
Df Model:                           9                                         
Covariance Type:            nonrobust                                         
==============================================================================
                 coef    std err          t      P>|t|      [0.025      0.975]
------------------------------------------------------------------------------
const         -0.4097      0.349     -1.173      0.241      -1.095       0.276
胎儿是否健康         0.0085      0.006      1.516      0.130      -0.003       0.020
孕妇BMI          0.0078      0.005      1.449      0.148      -0.003       0.018
检测孕周          -0.0001      0.000     -0.697      0.486      -0.001       0.000
检测抽血次数         0.0149      0.002      9.116      0.000       0.012       0.018
检测日期_num      -0.0001      0.000     -0.549      0.583      -0.000       0.000
末次月经_num    4.256e-05      0.000      0.229      0.819      -0.000       0.000
体重            -0.0036      0.002     -1.741      0.082      -0.008       0.000
身高             0.0033      0.002      1.556      0.120      -0.001       0.008
年龄            -0.0007      0.000     -2.464      0.014      -0.001      -0.000
==============================================================================
Omnibus:                      139.263   Durbin-Watson:                   1.932
Prob(Omnibus):                  0.000   Jarque-Bera (JB):              345.062
Skew:                           0.971   Prob(JB):                     1.18e-75
Kurtosis:                       5.699   Cond. No.                     1.34e+05
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
[2] The condition number is large, 1.34e+05. This might indicate that there are
strong multicollinearity or other numerical problems.

==================================================
模型评估指标
==================================================
均方误差 (MSE): 0.000890
均方根误差 (RMSE): 0.029841
决定系数 (R²): 0.253569

==================================================
线性回归表达式
==================================================
Y染色体浓度 = -0.409704 + 0.008531 * 胎儿是否健康 + 0.007802 * 孕妇BMI + -0.000146 * 检测孕周 + 0.014887 * 检测抽血次数 + -0.000101 * 检测日期_num + 0.000043 * 末次月经_num + -0.003572 * 体重 + 0.003338 * 身高 + -0.000748 * 年龄
轮廓系数 (Silhouette Score): 0.557
Calinski-Harabasz指数: 1901.625
Davies-Bouldin指数: 0.572

0类: [20.70, 31.53]
2类: [31.55, 35.42]
1类: [35.44, 46.88]

中间点:77 区间 [77, 81]: 0.95455 (样本数: 22, 满足条件: 21)
结果值: 95.455

中间点:78 区间 [77, 82]: 0.92593 (样本数: 27, 满足条件: 25)
结果值: 92.593

中间点:79 区间 [77, 83]: 0.87500 (样本数: 32, 满足条件: 28)
结果值: 87.500

中间点:80 区间 [77, 84]: 0.85714 (样本数: 42, 满足条件: 36)
结果值: 85.714

中间点:81 区间 [77, 85]: 0.88235 (样本数: 51, 满足条件: 45)
结果值: 88.235

中间点:82 区间 [78, 86]: 0.82759 (样本数: 58, 满足条件: 48)
结果值: 82.759

中间点:83 区间 [79, 87]: 0.81967 (样本数: 61, 满足条件: 50)
结果值: 81.967

中间点:84 区间 [80, 88]: 0.84286 (样本数: 70, 满足条件: 59)
结果值: 84.286

中间点:85 区间 [81, 89]: 0.85000 (样本数: 80, 满足条件: 68)
结果值: 83.901

中间点:86 区间 [82, 90]: 0.82143 (样本数: 84, 满足条件: 69)
结果值: 79.945

中间点:87 区间 [83, 91]: 0.85263 (样本数: 95, 满足条件: 81)
结果值: 81.966

中间点:88 区间 [84, 92]: 0.85859 (样本数: 99, 满足条件: 85)
结果值: 81.463

中间点:89 区间 [85, 93]: 0.84000 (样本数: 100, 满足条件: 84)
结果值: 78.505

中间点:90 区间 [86, 94]: 0.83158 (样本数: 95, 满足条件: 79)
结果值: 76.564

中间点:91 区间 [87, 95]: 0.86957 (样本数: 92, 满足条件: 80)
结果值: 79.264

中间点:92 区间 [88, 96]: 0.88542 (样本数: 96, 满足条件: 85)
结果值: 79.750

中间点:93 区间 [89, 97]: 0.87097 (样本数: 93, 满足条件: 81)
结果值: 77.207

中间点:94 区间 [90, 98]: 0.88372 (样本数: 86, 满足条件: 76)
结果值: 77.383

中间点:95 区间 [91, 99]: 0.91358 (样本数: 81, 满足条件: 74)
结果值: 79.270

中间点:96 区间 [92, 100]: 0.89706 (样本数: 68, 满足条件: 61)
结果值: 76.519

中间点:97 区间 [93, 101]: 0.91803 (样本数: 61, 满足条件: 56)
结果值: 77.518

中间点:98 区间 [94, 102]: 0.98305 (样本数: 59, 满足条件: 58)
结果值: 82.920

中间点:99 区间 [95, 103]: 0.98387 (样本数: 62, 满足条件: 61)
结果值: 81.904

中间点:100 区间 [96, 104]: 0.96154 (样本数: 52, 满足条件: 50)
结果值: 78.571

中间点:101 区间 [97, 105]: 0.96000 (样本数: 50, 满足条件: 48)
结果值: 77.319

中间点:102 区间 [98, 106]: 0.97674 (样本数: 43, 满足条件: 42)
结果值: 77.894

中间点:103 区间 [99, 107]: 0.97619 (样本数: 42, 满足条件: 41)
结果值: 76.740

中间点:104 区间 [100, 108]: 0.95000 (样本数: 40, 满足条件: 38)
结果值: 73.022

中间点:105 区间 [101, 109]: 0.95349 (样本数: 43, 满足条件: 41)
结果值: 72.272

中间点:106 区间 [102, 110]: 0.94340 (样本数: 53, 满足条件: 50)
结果值: 70.164

中间点:107 区间 [103, 111]: 0.90741 (样本数: 54, 满足条件: 49)
结果值: 65.466

中间点:108 区间 [104, 112]: 0.88525 (样本数: 61, 满足条件: 54)
结果值: 62.151

中间点:109 区间 [105, 113]: 0.89552 (样本数: 67, 满足条件: 60)
结果值: 62.080

中间点:110 区间 [106, 114]: 0.87500 (样本数: 72, 满足条件: 63)
结果值: 58.929

中间点:111 区间 [107, 115]: 0.85897 (样本数: 78, 满足条件: 67)
结果值: 56.227

中间点:112 区间 [108, 116]: 0.83951 (样本数: 81, 满足条件: 68)
结果值: 53.181

中间点:113 区间 [109, 117]: 0.83908 (样本数: 87, 满足条件: 73)
结果值: 52.040

中间点:114 区间 [110, 118]: 0.81818 (样本数: 88, 满足条件: 72)
结果值: 48.851

中间点:115 区间 [111, 119]: 0.80247 (样本数: 81, 满足条件: 65)
结果值: 46.181

中间点:116 区间 [112, 120]: 0.80822 (样本数: 73, 满足条件: 59)
结果值: 45.657

中间点:117 区间 [113, 121]: 0.80952 (样本数: 63, 满足条件: 51)
结果值: 44.689

中间点:118 区间 [114, 122]: 0.80357 (样本数: 56, 满足条件: 45)
结果值: 42.995

中间点:119 区间 [115, 123]: 0.80435 (样本数: 46, 满足条件: 37)
结果值: 41.973

中间点:120 区间 [116, 124]: 0.82500 (样本数: 40, 满足条件: 33)
结果值: 42.940

中间点:121 区间 [117, 125]: 0.85294 (样本数: 34, 满足条件: 29)
结果值: 44.635

中间点:122 区间 [118, 126]: 0.88462 (样本数: 26, 满足条件: 23)
结果值: 46.703

中间点:123 区间 [119, 127]: 0.94737 (样本数: 19, 满足条件: 18)
结果值: 51.880

中间点:124 区间 [120, 128]: 1.00000 (样本数: 15, 满足条件: 15)
结果值: 56.044

中间点:125 区间 [121, 129]: 1.00000 (样本数: 13, 满足条件: 13)
结果值: 54.945

中间点:126 区间 [122, 130]: 1.00000 (样本数: 11, 满足条件: 11)
结果值: 53.846

中间点:127 区间 [123, 131]: 1.00000 (样本数: 11, 满足条件: 11)
结果值: 52.747

中间点:128 区间 [124, 132]: 1.00000 (样本数: 8, 满足条件: 8)
结果值: 51.648

中间点:129 区间 [125, 133]: 0.81818 (样本数: 11, 满足条件: 9)
结果值: 32.368

中间点:130 区间 [126, 134]: 0.77778 (样本数: 9, 满足条件: 7)
结果值: 27.228

中间点:131 区间 [127, 135]: 0.66667 (样本数: 15, 满足条件: 10)
结果值: 15.018

中间点:132 区间 [128, 136]: 0.73684 (样本数: 19, 满足条件: 14)
结果值: 20.937

中间点:133 区间 [129, 137]: 0.73913 (样本数: 23, 满足条件: 17)
结果值: 20.067

中间点:134 区间 [130, 138]: 0.77778 (样本数: 27, 满足条件: 21)
结果值: 22.833

中间点:135 区间 [131, 139]: 0.80000 (样本数: 35, 满足条件: 28)
结果值: 23.956

中间点:136 区间 [132, 140]: 0.83721 (样本数: 43, 满足条件: 36)
结果值: 26.578

中间点:137 区间 [133, 141]: 0.83333 (样本数: 48, 满足条件: 40)
结果值: 25.092

中间点:138 区间 [134, 142]: 0.86275 (样本数: 51, 满足条件: 44)
结果值: 26.934

中间点:139 区间 [135, 143]: 0.87037 (样本数: 54, 满足条件: 47)
结果值: 26.597

中间点:140 区间 [136, 144]: 0.90385 (样本数: 52, 满足条件: 47)
结果值: 28.846

中间点:141 区间 [137, 145]: 0.90000 (样本数: 50, 满足条件: 45)
结果值: 27.363

中间点:142 区间 [138, 146]: 0.91667 (样本数: 48, 满足条件: 44)
结果值: 27.930

中间点:143 区间 [139, 147]: 0.89362 (样本数: 47, 满足条件: 42)
结果值: 24.527

中间点:144 区间 [140, 148]: 0.89744 (样本数: 39, 满足条件: 35)
结果值: 23.810

中间点:145 区间 [141, 149]: 0.87097 (样本数: 31, 满足条件: 27)
结果值: 20.064

中间点:146 区间 [142, 150]: 0.89286 (样本数: 28, 满足条件: 25)
结果值: 21.154

中间点:147 区间 [143, 151]: 0.90909 (样本数: 22, 满足条件: 20)
结果值: 21.678

中间点:148 区间 [144, 152]: 0.89474 (样本数: 19, 满足条件: 17)
结果值: 19.144

中间点:149 区间 [145, 153]: 0.93750 (样本数: 16, 满足条件: 15)
结果值: 22.321

中间点:150 区间 [146, 154]: 0.92857 (样本数: 14, 满足条件: 13)
结果值: 20.330

中间点:151 区间 [147, 155]: 0.83333 (样本数: 12, 满足条件: 10)
结果值: 9.707

中间点:152 区间 [148, 156]: 0.88889 (样本数: 9, 满足条件: 8)
结果值: 14.164

中间点:153 区间 [149, 157]: 0.85714 (样本数: 7, 满足条件: 6)
结果值: 9.890

中间点:154 区间 [150, 158]: 0.80000 (样本数: 5, 满足条件: 4)
结果值: 3.077

中间点:155 区间 [151, 159]: 0.66667 (样本数: 3, 满足条件: 2)
结果值: -11.355

中间点:156 区间 [152, 160]: 0.75000 (样本数: 4, 满足条件: 3)
结果值: -4.121

中间点:157 区间 [153, 161]: 0.90000 (样本数: 10, 满足条件: 9)
结果值: 9.780

中间点:158 区间 [154, 162]: 0.93333 (样本数: 15, 满足条件: 14)
结果值: 12.015

中间点:159 区间 [155, 163]: 0.95000 (样本数: 20, 满足条件: 19)
结果值: 12.582

中间点:160 区间 [156, 164]: 1.00000 (样本数: 21, 满足条件: 21)
结果值: 16.484

中间点:161 区间 [157, 165]: 1.00000 (样本数: 24, 满足条件: 24)
结果值: 15.385

中间点:162 区间 [158, 166]: 1.00000 (样本数: 29, 满足条件: 29)
结果值: 14.286

中间点:163 区间 [159, 167]: 1.00000 (样本数: 35, 满足条件: 35)
结果值: 13.187

中间点:164 区间 [160, 168]: 1.00000 (样本数: 41, 满足条件: 41)
结果值: 12.088

中间点:165 区间 [161, 169]: 1.00000 (样本数: 44, 满足条件: 44)
结果值: 10.989

中间点:166 区间 [162, 170]: 1.00000 (样本数: 47, 满足条件: 47)
结果值: 9.890

中间点:167 区间 [163, 171]: 1.00000 (样本数: 41, 满足条件: 41)
结果值: 8.791

中间点:168 区间 [164, 172]: 1.00000 (样本数: 38, 满足条件: 38)
结果值: 7.692

中间点:169 区间 [165, 173]: 1.00000 (样本数: 38, 满足条件: 38)
结果值: 6.593

中间点:170 区间 [166, 174]: 1.00000 (样本数: 36, 满足条件: 36)
结果值: 5.495

中间点:171 区间 [167, 175]: 1.00000 (样本数: 31, 满足条件: 31)
结果值: 4.396

中间点:172 区间 [168, 176]: 1.00000 (样本数: 25, 满足条件: 25)
结果值: 3.297

中间点:173 区间 [169, 177]: 1.00000 (样本数: 22, 满足条件: 22)
结果值: 2.198

中间点:174 区间 [170, 178]: 1.00000 (样本数: 17, 满足条件: 17)
结果值: 1.099

中间点:175 区间 [171, 179]: 1.00000 (样本数: 8, 满足条件: 8)
结果值: 0.000

中间点:176 区间 [172, 180]: 1.00000 (样本数: 8, 满足条件: 8)
结果值: -1.099

中间点:177 区间 [173, 181]: 1.00000 (样本数: 6, 满足条件: 6)
结果值: -2.198

中间点:178 区间 [174, 182]: 1.00000 (样本数: 5, 满足条件: 5)
结果值: -3.297

中间点:179 区间 [175, 183]: 1.00000 (样本数: 6, 满足条件: 6)
结果值: -4.396

中间点:180 区间 [176, 184]: 1.00000 (样本数: 6, 满足条件: 6)
结果值: -5.495

中间点:181 区间 [177, 185]: 1.00000 (样本数: 7, 满足条件: 7)
结果值: -6.593

中间点:182 区间 [178, 185]: 1.00000 (样本数: 4, 满足条件: 4)
结果值: -7.692

中间点:183 区间 [179, 185]: 1.00000 (样本数: 4, 满足条件: 4)
结果值: -8.791

中间点:184 区间 [180, 185]: 1.00000 (样本数: 4, 满足条件: 4)
结果值: -9.890

中间点:185 区间 [181, 185]: 1.00000 (样本数: 4, 满足条件: 4)
结果值: -10.989

中间点:79 区间 [79, 83]: 0.75000 (样本数: 4, 满足条件: 3)
结果值: 75.000

中间点:80 区间 [79, 84]: 0.80000 (样本数: 5, 满足条件: 4)
结果值: 80.000

中间点:81 区间 [79, 85]: 0.83333 (样本数: 6, 满足条件: 5)
结果值: 83.333

中间点:82 区间 [79, 86]: 0.72727 (样本数: 11, 满足条件: 8)
结果值: 72.727

中间点:83 区间 [79, 87]: 0.72727 (样本数: 11, 满足条件: 8)
结果值: 72.727

中间点:84 区间 [80, 88]: 0.66667 (样本数: 12, 满足条件: 8)
结果值: 66.667

中间点:85 区间 [81, 89]: 0.66667 (样本数: 12, 满足条件: 8)
结果值: 65.568

中间点:86 区间 [82, 90]: 0.61538 (样本数: 13, 满足条件: 8)
结果值: 59.341

中间点:87 区间 [83, 91]: 0.50000 (样本数: 16, 满足条件: 8)
结果值: 46.703

中间点:88 区间 [84, 92]: 0.50000 (样本数: 18, 满足条件: 9)
结果值: 45.604

中间点:89 区间 [85, 93]: 0.52632 (样本数: 19, 满足条件: 10)
结果值: 47.137

中间点:90 区间 [86, 94]: 0.52632 (样本数: 19, 满足条件: 10)
结果值: 46.038

中间点:91 区间 [87, 95]: 0.55556 (样本数: 18, 满足条件: 10)
结果值: 47.863

中间点:92 区间 [88, 96]: 0.60000 (样本数: 20, 满足条件: 12)
结果值: 51.209

中间点:93 区间 [89, 97]: 0.61111 (样本数: 18, 满足条件: 11)
结果值: 51.221

中间点:94 区间 [90, 98]: 0.58824 (样本数: 17, 满足条件: 10)
结果值: 47.835

中间点:95 区间 [91, 99]: 0.60000 (样本数: 15, 满足条件: 9)
结果值: 47.912

中间点:96 区间 [92, 100]: 0.76923 (样本数: 13, 满足条件: 10)
结果值: 63.736

中间点:97 区间 [93, 101]: 0.90000 (样本数: 10, 满足条件: 9)
结果值: 75.714

中间点:98 区间 [94, 102]: 0.88889 (样本数: 9, 满足条件: 8)
结果值: 73.504

中间点:99 区间 [95, 103]: 0.88889 (样本数: 9, 满足条件: 8)
结果值: 72.405

中间点:100 区间 [96, 104]: 1.00000 (样本数: 5, 满足条件: 5)
结果值: 82.418

中间点:101 区间 [97, 105]: 1.00000 (样本数: 4, 满足条件: 4)
结果值: 81.319

中间点:102 区间 [98, 106]: 1.00000 (样本数: 5, 满足条件: 5)
结果值: 80.220

中间点:103 区间 [99, 107]: 0.83333 (样本数: 6, 满足条件: 5)
结果值: 62.454

中间点:104 区间 [100, 108]: 0.83333 (样本数: 6, 满足条件: 5)
结果值: 61.355

中间点:105 区间 [101, 109]: 0.85714 (样本数: 7, 满足条件: 6)
结果值: 62.637

中间点:106 区间 [102, 110]: 0.77778 (样本数: 9, 满足条件: 7)
结果值: 53.602

中间点:107 区间 [103, 111]: 0.72727 (样本数: 11, 满足条件: 8)
结果值: 47.453

中间点:108 区间 [104, 112]: 0.66667 (样本数: 12, 满足条件: 8)
结果值: 40.293

中间点:109 区间 [105, 113]: 0.66667 (样本数: 15, 满足条件: 10)
结果值: 39.194

中间点:110 区间 [106, 114]: 0.55000 (样本数: 20, 满足条件: 11)
结果值: 26.429

中间点:111 区间 [107, 115]: 0.60870 (样本数: 23, 满足条件: 14)
结果值: 31.199

中间点:112 区间 [108, 116]: 0.65217 (样本数: 23, 满足条件: 15)
结果值: 34.448

中间点:113 区间 [109, 117]: 0.66667 (样本数: 24, 满足条件: 16)
结果值: 34.799

中间点:114 区间 [110, 118]: 0.63636 (样本数: 22, 满足条件: 14)
结果值: 30.669

中间点:115 区间 [111, 119]: 0.66667 (样本数: 21, 满足条件: 14)
结果值: 32.601

中间点:116 区间 [112, 120]: 0.68421 (样本数: 19, 满足条件: 13)
结果值: 33.256

中间点:117 区间 [113, 121]: 0.66667 (样本数: 18, 满足条件: 12)
结果值: 30.403

中间点:118 区间 [114, 122]: 0.66667 (样本数: 15, 满足条件: 10)
结果值: 29.304

中间点:119 区间 [115, 123]: 0.81818 (样本数: 11, 满足条件: 9)
结果值: 43.357

中间点:120 区间 [116, 124]: 0.75000 (样本数: 8, 满足条件: 6)
结果值: 35.440

中间点:121 区间 [117, 125]: 0.71429 (样本数: 7, 满足条件: 5)
结果值: 30.769

中间点:122 区间 [118, 126]: 0.66667 (样本数: 6, 满足条件: 4)
结果值: 24.908

中间点:123 区间 [119, 127]: 0.66667 (样本数: 6, 满足条件: 4)
结果值: 23.810

中间点:124 区间 [120, 128]: 0.60000 (样本数: 5, 满足条件: 3)
结果值: 16.044

中间点:125 区间 [121, 129]: 0.50000 (样本数: 4, 满足条件: 2)
结果值: 4.945

中间点:126 区间 [122, 130]: 0.66667 (样本数: 3, 满足条件: 2)
结果值: 20.513

中间点:127 区间 [123, 131]: 0.66667 (样本数: 3, 满足条件: 2)
结果值: 19.414

中间点:128 区间 [124, 132]: 1.00000 (样本数: 2, 满足条件: 2)
结果值: 51.648

中间点:129 区间 [125, 133]: 1.00000 (样本数: 2, 满足条件: 2)
结果值: 50.549

中间点:130 区间 [126, 134]: 1.00000 (样本数: 3, 满足条件: 3)
结果值: 49.451

中间点:131 区间 [127, 135]: 1.00000 (样本数: 3, 满足条件: 3)
结果值: 48.352

中间点:132 区间 [128, 136]: 0.60000 (样本数: 5, 满足条件: 3)
结果值: 7.253

中间点:133 区间 [129, 137]: 0.75000 (样本数: 8, 满足条件: 6)
结果值: 21.154

中间点:134 区间 [130, 138]: 0.77778 (样本数: 9, 满足条件: 7)
结果值: 22.833

中间点:135 区间 [131, 139]: 0.70000 (样本数: 10, 满足条件: 7)
结果值: 13.956

中间点:136 区间 [132, 140]: 0.66667 (样本数: 12, 满足条件: 8)
结果值: 9.524

中间点:137 区间 [133, 141]: 0.58824 (样本数: 17, 满足条件: 10)
结果值: 0.582

中间点:138 区间 [134, 142]: 0.52632 (样本数: 19, 满足条件: 10)
结果值: -6.709

中间点:139 区间 [135, 143]: 0.52632 (样本数: 19, 满足条件: 10)
结果值: -7.808

中间点:140 区间 [136, 144]: 0.62500 (样本数: 24, 满足条件: 15)
结果值: 0.962

中间点:141 区间 [137, 145]: 0.69565 (样本数: 23, 满足条件: 16)
结果值: 6.928

中间点:142 区间 [138, 146]: 0.56522 (样本数: 23, 满足条件: 13)
结果值: -7.215

中间点:143 区间 [139, 147]: 0.56522 (样本数: 23, 满足条件: 13)
结果值: -8.313

中间点:144 区间 [140, 148]: 0.64000 (样本数: 25, 满足条件: 16)
结果值: -1.934

中间点:145 区间 [141, 149]: 0.65217 (样本数: 23, 满足条件: 15)
结果值: -1.816

中间点:146 区间 [142, 150]: 0.66667 (样本数: 18, 满足条件: 12)
结果值: -1.465

中间点:147 区间 [143, 151]: 0.73333 (样本数: 15, 满足条件: 11)
结果值: 4.103

中间点:148 区间 [144, 152]: 0.71429 (样本数: 14, 满足条件: 10)
结果值: 1.099

中间点:149 区间 [145, 153]: 0.55556 (样本数: 9, 满足条件: 5)
结果值: -15.873

中间点:150 区间 [146, 154]: 0.55556 (样本数: 9, 满足条件: 5)
结果值: -16.972

中间点:151 区间 [147, 155]: 0.83333 (样本数: 6, 满足条件: 5)
结果值: 9.707

中间点:152 区间 [148, 156]: 0.80000 (样本数: 5, 满足条件: 4)
结果值: 5.275

中间点:153 区间 [149, 157]: 0.50000 (样本数: 2, 满足条件: 1)
结果值: -25.824

中间点:154 区间 [150, 158]: 0.50000 (样本数: 2, 满足条件: 1)
结果值: -26.923

中间点:155 区间 [151, 159]: 1.00000 (样本数: 2, 满足条件: 2)
结果值: 21.978

中间点:156 区间 [152, 160]: 1.00000 (样本数: 3, 满足条件: 3)
结果值: 20.879

中间点:157 区间 [153, 161]: 0.80000 (样本数: 5, 满足条件: 4)
结果值: -0.220

中间点:158 区间 [154, 162]: 0.83333 (样本数: 6, 满足条件: 5)
结果值: 2.015

中间点:159 区间 [155, 163]: 0.85714 (样本数: 7, 满足条件: 6)
结果值: 3.297

中间点:160 区间 [156, 164]: 0.91667 (样本数: 12, 满足条件: 11)
结果值: 8.150

中间点:161 区间 [157, 165]: 0.85714 (样本数: 14, 满足条件: 12)
结果值: 1.099

中间点:162 区间 [158, 166]: 0.88889 (样本数: 18, 满足条件: 16)
结果值: 3.175

中间点:163 区间 [159, 167]: 0.90476 (样本数: 21, 满足条件: 19)
结果值: 3.663

中间点:164 区间 [160, 168]: 0.91304 (样本数: 23, 满足条件: 21)
结果值: 3.392

中间点:165 区间 [161, 169]: 0.91304 (样本数: 23, 满足条件: 21)
结果值: 2.293

中间点:166 区间 [162, 170]: 0.95833 (样本数: 24, 满足条件: 23)
结果值: 5.723

中间点:167 区间 [163, 171]: 0.96000 (样本数: 25, 满足条件: 24)
结果值: 4.791

中间点:168 区间 [164, 172]: 0.88889 (样本数: 27, 满足条件: 24)
结果值: -3.419

中间点:169 区间 [165, 173]: 0.80000 (样本数: 25, 满足条件: 20)
结果值: -13.407

中间点:170 区间 [166, 174]: 0.83333 (样本数: 24, 满足条件: 20)
结果值: -11.172

中间点:171 区间 [167, 175]: 0.80000 (样本数: 20, 满足条件: 16)
结果值: -15.604

中间点:172 区间 [168, 176]: 0.76471 (样本数: 17, 满足条件: 13)
结果值: -20.233

中间点:173 区间 [169, 177]: 0.71429 (样本数: 14, 满足条件: 10)
结果值: -26.374

中间点:174 区间 [170, 178]: 0.69231 (样本数: 13, 满足条件: 9)
结果值: -29.670

中间点:175 区间 [171, 179]: 0.60000 (样本数: 10, 满足条件: 6)
结果值: -40.000

中间点:176 区间 [172, 180]: 0.55556 (样本数: 9, 满足条件: 5)
结果值: -45.543

中间点:177 区间 [173, 181]: 0.60000 (样本数: 5, 满足条件: 3)
结果值: -42.198

中间点:178 区间 [174, 182]: 1.00000 (样本数: 3, 满足条件: 3)
结果值: -3.297

中间点:179 区间 [175, 183]: 1.00000 (样本数: 2, 满足条件: 2)
结果值: -4.396

中间点:180 区间 [176, 184]: 1.00000 (样本数: 2, 满足条件: 2)
结果值: -5.495

中间点:181 区间 [177, 185]: 1.00000 (样本数: 3, 满足条件: 3)
结果值: -6.593

中间点:182 区间 [178, 185]: 1.00000 (样本数: 3, 满足条件: 3)
结果值: -7.692

中间点:183 区间 [179, 185]: 1.00000 (样本数: 3, 满足条件: 3)
结果值: -8.791

中间点:184 区间 [180, 185]: 1.00000 (样本数: 3, 满足条件: 3)
结果值: -9.890

中间点:185 区间 [181, 185]: 1.00000 (样本数: 2, 满足条件: 2)
结果值: -10.989

中间点:77 区间 [77, 81]: 0.80000 (样本数: 10, 满足条件: 8)
结果值: 80.000

中间点:78 区间 [77, 82]: 0.85714 (样本数: 14, 满足条件: 12)
结果值: 85.714

中间点:79 区间 [77, 83]: 0.85000 (样本数: 20, 满足条件: 17)
结果值: 85.000

中间点:80 区间 [77, 84]: 0.85185 (样本数: 27, 满足条件: 23)
结果值: 85.185

中间点:81 区间 [77, 85]: 0.80556 (样本数: 36, 满足条件: 29)
结果值: 80.556

中间点:82 区间 [78, 86]: 0.83333 (样本数: 48, 满足条件: 40)
结果值: 83.333

中间点:83 区间 [79, 87]: 0.86000 (样本数: 50, 满足条件: 43)
结果值: 86.000

中间点:84 区间 [80, 88]: 0.84483 (样本数: 58, 满足条件: 49)
结果值: 84.483

中间点:85 区间 [81, 89]: 0.83871 (样本数: 62, 满足条件: 52)
结果值: 82.772

中间点:86 区间 [82, 90]: 0.86154 (样本数: 65, 满足条件: 56)
结果值: 83.956

中间点:87 区间 [83, 91]: 0.81690 (样本数: 71, 满足条件: 58)
结果值: 78.393

中间点:88 区间 [84, 92]: 0.83333 (样本数: 78, 满足条件: 65)
结果值: 78.938

中间点:89 区间 [85, 93]: 0.85000 (样本数: 80, 满足条件: 68)
结果值: 79.505

中间点:90 区间 [86, 94]: 0.88158 (样本数: 76, 满足条件: 67)
结果值: 81.564

中间点:91 区间 [87, 95]: 0.89333 (样本数: 75, 满足条件: 67)
结果值: 81.641

中间点:92 区间 [88, 96]: 0.88750 (样本数: 80, 满足条件: 71)
结果值: 79.959

中间点:93 区间 [89, 97]: 0.90000 (样本数: 80, 满足条件: 72)
结果值: 80.110

中间点:94 区间 [90, 98]: 0.91139 (样本数: 79, 满足条件: 72)
结果值: 80.150

中间点:95 区间 [91, 99]: 0.91250 (样本数: 80, 满足条件: 73)
结果值: 79.162

中间点:96 区间 [92, 100]: 0.96053 (样本数: 76, 满足条件: 73)
结果值: 82.866

中间点:97 区间 [93, 101]: 0.97101 (样本数: 69, 满足条件: 67)
结果值: 82.816

中间点:98 区间 [94, 102]: 0.97015 (样本数: 67, 满足条件: 65)
结果值: 81.630

中间点:99 区间 [95, 103]: 0.97059 (样本数: 68, 满足条件: 66)
结果值: 80.575

中间点:100 区间 [96, 104]: 0.96610 (样本数: 59, 满足条件: 57)
结果值: 79.028

中间点:101 区间 [97, 105]: 0.98113 (样本数: 53, 满足条件: 52)
结果值: 79.432

中间点:102 区间 [98, 106]: 0.98113 (样本数: 53, 满足条件: 52)
结果值: 78.333

中间点:103 区间 [99, 107]: 0.98214 (样本数: 56, 满足条件: 55)
结果值: 77.335

中间点:104 区间 [100, 108]: 0.98214 (样本数: 56, 满足条件: 55)
结果值: 76.236

中间点:105 区间 [101, 109]: 0.96610 (样本数: 59, 满足条件: 57)
结果值: 73.533

中间点:106 区间 [102, 110]: 0.96667 (样本数: 60, 满足条件: 58)
结果值: 72.491

中间点:107 区间 [103, 111]: 0.96491 (样本数: 57, 满足条件: 55)
结果值: 71.217

中间点:108 区间 [104, 112]: 0.91667 (样本数: 60, 满足条件: 55)
结果值: 65.293

中间点:109 区间 [105, 113]: 0.89041 (样本数: 73, 满足条件: 65)
结果值: 61.569

中间点:110 区间 [106, 114]: 0.89744 (样本数: 78, 满足条件: 70)
结果值: 61.172

中间点:111 区间 [107, 115]: 0.88462 (样本数: 78, 满足条件: 69)
结果值: 58.791

中间点:112 区间 [108, 116]: 0.85714 (样本数: 84, 满足条件: 72)
结果值: 54.945

中间点:113 区间 [109, 117]: 0.84524 (样本数: 84, 满足条件: 71)
结果值: 52.656

中间点:114 区间 [110, 118]: 0.84211 (样本数: 76, 满足条件: 64)
结果值: 51.243

中间点:115 区间 [111, 119]: 0.81081 (样本数: 74, 满足条件: 60)
结果值: 47.015

中间点:116 区间 [112, 120]: 0.80556 (样本数: 72, 满足条件: 58)
结果值: 45.391

中间点:117 区间 [113, 121]: 0.82353 (样本数: 68, 满足条件: 56)
结果值: 46.089

中间点:118 区间 [114, 122]: 0.83019 (样本数: 53, 满足条件: 44)
结果值: 45.656

中间点:119 区间 [115, 123]: 0.79592 (样本数: 49, 满足条件: 39)
结果值: 41.130

中间点:120 区间 [116, 124]: 0.80952 (样本数: 42, 满足条件: 34)
结果值: 41.392

中间点:121 区间 [117, 125]: 0.83333 (样本数: 30, 满足条件: 25)
结果值: 42.674

中间点:122 区间 [118, 126]: 0.83333 (样本数: 24, 满足条件: 20)
结果值: 41.575

中间点:123 区间 [119, 127]: 0.82609 (样本数: 23, 满足条件: 19)
结果值: 39.752

中间点:124 区间 [120, 128]: 0.85000 (样本数: 20, 满足条件: 17)
结果值: 41.044

中间点:125 区间 [121, 129]: 0.83333 (样本数: 18, 满足条件: 15)
结果值: 38.278

中间点:126 区间 [122, 130]: 0.84615 (样本数: 13, 满足条件: 11)
结果值: 38.462

中间点:127 区间 [123, 131]: 0.83333 (样本数: 12, 满足条件: 10)
结果值: 36.081

中间点:128 区间 [124, 132]: 0.87500 (样本数: 8, 满足条件: 7)
结果值: 39.148

中间点:129 区间 [125, 133]: 0.90000 (样本数: 10, 满足条件: 9)
结果值: 40.549

中间点:130 区间 [126, 134]: 0.90000 (样本数: 10, 满足条件: 9)
结果值: 39.451

中间点:131 区间 [127, 135]: 0.91667 (样本数: 12, 满足条件: 11)
结果值: 40.018

中间点:132 区间 [128, 136]: 0.93333 (样本数: 15, 满足条件: 14)
结果值: 40.586

中间点:133 区间 [129, 137]: 0.93333 (样本数: 15, 满足条件: 14)
结果值: 39.487

中间点:134 区间 [130, 138]: 0.94118 (样本数: 17, 满足条件: 16)
结果值: 39.173

中间点:135 区间 [131, 139]: 0.94737 (样本数: 19, 满足条件: 18)
结果值: 38.693

中间点:136 区间 [132, 140]: 0.86667 (样本数: 30, 满足条件: 26)
结果值: 29.524

中间点:137 区间 [133, 141]: 0.89189 (样本数: 37, 满足条件: 33)
结果值: 30.947

中间点:138 区间 [134, 142]: 0.89474 (样本数: 38, 满足条件: 34)
结果值: 30.133

中间点:139 区间 [135, 143]: 0.89189 (样本数: 37, 满足条件: 33)
结果值: 28.750

中间点:140 区间 [136, 144]: 0.89189 (样本数: 37, 满足条件: 33)
结果值: 27.651

中间点:141 区间 [137, 145]: 0.88571 (样本数: 35, 满足条件: 31)
结果值: 25.934

中间点:142 区间 [138, 146]: 0.86486 (样本数: 37, 满足条件: 32)
结果值: 22.750

中间点:143 区间 [139, 147]: 0.86111 (样本数: 36, 满足条件: 31)
结果值: 21.276

中间点:144 区间 [140, 148]: 0.85294 (样本数: 34, 满足条件: 29)
结果值: 19.360

中间点:145 区间 [141, 149]: 0.87500 (样本数: 24, 满足条件: 21)
结果值: 20.467

中间点:146 区间 [142, 150]: 0.83333 (样本数: 18, 满足条件: 15)
结果值: 15.201

中间点:147 区间 [143, 151]: 0.78571 (样本数: 14, 满足条件: 11)
结果值: 9.341

中间点:148 区间 [144, 152]: 0.80000 (样本数: 15, 满足条件: 12)
结果值: 9.670

中间点:149 区间 [145, 153]: 0.76923 (样本数: 13, 满足条件: 10)
结果值: 5.495

中间点:150 区间 [146, 154]: 0.75000 (样本数: 12, 满足条件: 9)
结果值: 2.473

中间点:151 区间 [147, 155]: 0.87500 (样本数: 8, 满足条件: 7)
结果值: 13.874

中间点:152 区间 [148, 156]: 0.85714 (样本数: 7, 满足条件: 6)
结果值: 10.989

中间点:153 区间 [149, 157]: 0.85714 (样本数: 7, 满足条件: 6)
结果值: 9.890

中间点:154 区间 [150, 158]: 1.00000 (样本数: 6, 满足条件: 6)
结果值: 23.077

中间点:155 区间 [151, 159]: 1.00000 (样本数: 4, 满足条件: 4)
结果值: 21.978

中间点:156 区间 [152, 160]: 0.75000 (样本数: 4, 满足条件: 3)
结果值: -4.121

中间点:157 区间 [153, 161]: 0.60000 (样本数: 5, 满足条件: 3)
结果值: -20.220

中间点:158 区间 [154, 162]: 0.70000 (样本数: 10, 满足条件: 7)
结果值: -11.319

中间点:159 区间 [155, 163]: 0.78571 (样本数: 14, 满足条件: 11)
结果值: -3.846

中间点:160 区间 [156, 164]: 0.85000 (样本数: 20, 满足条件: 17)
结果值: 1.484

中间点:161 区间 [157, 165]: 0.90000 (样本数: 30, 满足条件: 27)
结果值: 5.385

中间点:162 区间 [158, 166]: 0.85294 (样本数: 34, 满足条件: 29)
结果值: -0.420

中间点:163 区间 [159, 167]: 0.87500 (样本数: 40, 满足条件: 35)
结果值: 0.687

中间点:164 区间 [160, 168]: 0.88636 (样本数: 44, 满足条件: 39)
结果值: 0.724

中间点:165 区间 [161, 169]: 0.91667 (样本数: 48, 满足条件: 44)
结果值: 2.656

中间点:166 区间 [162, 170]: 0.92000 (样本数: 50, 满足条件: 46)
结果值: 1.890

中间点:167 区间 [163, 171]: 0.93750 (样本数: 48, 满足条件: 45)
结果值: 2.541

中间点:168 区间 [164, 172]: 0.93182 (样本数: 44, 满足条件: 41)
结果值: 0.874

中间点:169 区间 [165, 173]: 0.92683 (样本数: 41, 满足条件: 38)
结果值: -0.724

中间点:170 区间 [166, 174]: 0.90625 (样本数: 32, 满足条件: 29)
结果值: -3.880

中间点:171 区间 [167, 175]: 0.96429 (样本数: 28, 满足条件: 27)
结果值: 0.824

中间点:172 区间 [168, 176]: 0.95455 (样本数: 22, 满足条件: 21)
结果值: -1.249

中间点:173 区间 [169, 177]: 0.94444 (样本数: 18, 满足条件: 17)
结果值: -3.358

中间点:174 区间 [170, 178]: 0.92308 (样本数: 13, 满足条件: 12)
结果值: -6.593

中间点:175 区间 [171, 179]: 1.00000 (样本数: 8, 满足条件: 8)
结果值: 0.000

中间点:176 区间 [172, 180]: 1.00000 (样本数: 4, 满足条件: 4)
结果值: -1.099

中间点:177 区间 [173, 181]: 1.00000 (样本数: 4, 满足条件: 4)
结果值: -2.198

中间点:178 区间 [174, 182]: 1.00000 (样本数: 1, 满足条件: 1)
结果值: -3.297

中间点:179 区间 [175, 183]: 无数据

中间点:180 区间 [176, 184]: 无数据

中间点:181 区间 [177, 185]: 无数据

中间点:182 区间 [178, 186]: 无数据

中间点:183 区间 [179, 187]: 无数据

中间点:184 区间 [180, 188]: 无数据

中间点:185 区间 [181, 189]: 无数据

中间点:186 区间 [182, 190]: 无数据

中间点:187 区间 [183, 191]: 无数据

中间点:188 区间 [184, 192]: 无数据

中间点:189 区间 [185, 193]: 无数据

中间点:190 区间 [186, 194]: 1.00000 (样本数: 2, 满足条件: 2)
结果值: -16.484

中间点:191 区间 [187, 195]: 1.00000 (样本数: 2, 满足条件: 2)
结果值: -17.582

中间点:192 区间 [188, 196]: 1.00000 (样本数: 2, 满足条件: 2)
结果值: -18.681

中间点:193 区间 [189, 197]: 1.00000 (样本数: 2, 满足条件: 2)
结果值: -19.780

中间点:194 区间 [190, 198]: 1.00000 (样本数: 2, 满足条件: 2)
结果值: -20.879

中间点:195 区间 [191, 199]: 1.00000 (样本数: 2, 满足条件: 2)
结果值: -21.978

中间点:196 区间 [192, 200]: 1.00000 (样本数: 2, 满足条件: 2)
结果值: -23.077

中间点:197 区间 [193, 201]: 1.00000 (样本数: 2, 满足条件: 2)
结果值: -24.176

中间点:198 区间 [194, 202]: 1.00000 (样本数: 2, 满足条件: 2)
结果值: -25.275

中间点:199 区间 [195, 203]: 1.00000 (样本数: 1, 满足条件: 1)
结果值: -26.374

中间点:200 区间 [196, 203]: 1.00000 (样本数: 1, 满足条件: 1)
结果值: -27.473

中间点:201 区间 [197, 203]: 1.00000 (样本数: 1, 满足条件: 1)
结果值: -28.571

中间点:202 区间 [198, 203]: 1.00000 (样本数: 1, 满足条件: 1)
结果值: -29.670

中间点:203 区间 [199, 203]: 1.00000 (样本数: 1, 满足条件: 1)
结果值: -30.769
Iteration 1: norm_delta = 2.68e+00, step_size = 0.9500, log_lik = -1101.48597, newton_decrement = 2.40e+02, seconds_since_start = 0.0
Iteration 2: norm_delta = 3.03e+00, step_size = 0.9500, log_lik = -819.59705, newton_decrement = 9.80e+01, seconds_since_start = 0.0
Iteration 3: norm_delta = 5.24e+00, step_size = 0.9500, log_lik = -691.29162, newton_decrement = 8.24e+01, seconds_since_start = 0.0
Iteration 4: norm_delta = 6.32e+00, step_size = 0.2327, log_lik = -656.84978, newton_decrement = 8.04e+01, seconds_since_start = 0.0
Iteration 5: norm_delta = 6.76e+00, step_size = 0.0741, log_lik = -645.34750, newton_decrement = 8.01e+01, seconds_since_start = 0.0
Iteration 6: norm_delta = 6.91e+00, step_size = 0.0236, log_lik = -641.61082, newton_decrement = 8.00e+01, seconds_since_start = 0.0
Iteration 7: norm_delta = 6.96e+00, step_size = 0.0075, log_lik = -640.41247, newton_decrement = 8.00e+01, seconds_since_start = 0.0
Iteration 8: norm_delta = 6.98e+00, step_size = 0.0024, log_lik = -640.02994, newton_decrement = 7.99e+01, seconds_since_start = 0.0
Iteration 9: norm_delta = 6.98e+00, step_size = 0.0008, log_lik = -639.90802, newton_decrement = 7.99e+01, seconds_since_start = 0.0
Iteration 10: norm_delta = 6.98e+00, step_size = 0.0002, log_lik = -639.86917, newton_decrement = 7.99e+01, seconds_since_start = 0.0
Iteration 11: norm_delta = 6.98e+00, step_size = 0.0001, log_lik = -639.85680, newton_decrement = 7.99e+01, seconds_since_start = 0.0
Iteration 12: norm_delta = 6.98e+00, step_size = 0.0000, log_lik = -639.85286, newton_decrement = 7.99e+01, seconds_since_start = 0.0
Iteration 13: norm_delta = 6.98e+00, step_size = 0.0000, log_lik = -639.85161, newton_decrement = 7.99e+01, seconds_since_start = 0.0
Convergence failed. See any warning messages.
Cox模型摘要:
<lifelines.CoxPHFitter: fitted with 313 total observations, 75 right-censored observations>
             duration col = '检测孕周'
                event col = 'Y染色体浓度'
      baseline estimation = breslow
   number of observations = 313
number of events observed = 238
   partial log-likelihood = -639.85
         time fit was run = 2025-09-07 06:19:06 UTC

---
           coef exp(coef)  se(coef)  coef lower 95%  coef upper 95% exp(coef) lower 95% exp(coef) upper 95%
covariate                                                                                                  
PCA1      -0.02      0.98      0.00           -0.02           -0.01                0.98                0.99
PCA2       0.17      1.18      0.01            0.14            0.19                1.15                1.21
PCA3      -0.12      0.89      0.01           -0.14           -0.10                0.87                0.90
PCA4      -0.10      0.91      0.01           -0.12           -0.08                0.89                0.92

           cmp to      z      p  -log2(p)
covariate                                
PCA1         0.00 -10.05 <0.005     76.55
PCA2         0.00  13.18 <0.005    129.39
PCA3         0.00 -11.95 <0.005    106.85
PCA4         0.00 -10.30 <0.005     80.22
---
Concordance = 1.00
Partial AIC = 1287.70
log-likelihood ratio test = 923.27 on 4 df
-log2(p) of ll-ratio test = 657.14


比例风险假设检验:
The ``p_value_threshold`` is set at 0.05. Even under the null hypothesis of no violations, some
covariates will be below the threshold by chance. This is compounded when there are many covariates.
Similarly, when there are lots of observations, even minor deviances from the proportional hazard
assumption will be flagged.

With that in mind, it's best to use a combination of statistical tests and visual tests to determine
the most serious violations. Produce visual plots using ``check_assumptions(..., show_plots=True)``
and looking for non-constant lines. See link [A] below for a full example.

<lifelines.StatisticalResult: proportional_hazard_test>
 null_distribution = chi squared
degrees_of_freedom = 1
             model = <lifelines.CoxPHFitter: fitted with 313 total observations, 75 right-censored observations>
         test_name = proportional_hazard_test

---
           test_statistic    p  -log2(p)
PCA1 km              4.02 0.05      4.47
     rank            3.53 0.06      4.05
PCA2 km              4.21 0.04      4.63
     rank            3.72 0.05      4.22
PCA3 km              2.62 0.11      3.25
     rank            2.50 0.11      3.13
PCA4 km              3.06 0.08      3.64
     rank            2.79 0.09      3.40


1. Variable 'PCA1' failed the non-proportional test: p-value is 0.0451.

   Advice 1: the functional form of the variable 'PCA1' might be incorrect. That is, there may be
non-linear terms missing. The proportional hazard test used is very sensitive to incorrect
functional forms. See documentation in link [D] below on how to specify a functional form.

   Advice 2: try binning the variable 'PCA1' using pd.cut, and then specify it in `strata=['PCA1',
...]` in the call in `.fit`. See documentation in link [B] below.

   Advice 3: try adding an interaction term with your time variable. See documentation in link [C]
below.


2. Variable 'PCA2' failed the non-proportional test: p-value is 0.0403.

   Advice 1: the functional form of the variable 'PCA2' might be incorrect. That is, there may be
non-linear terms missing. The proportional hazard test used is very sensitive to incorrect
functional forms. See documentation in link [D] below on how to specify a functional form.

   Advice 2: try binning the variable 'PCA2' using pd.cut, and then specify it in `strata=['PCA2',
...]` in the call in `.fit`. See documentation in link [B] below.

   Advice 3: try adding an interaction term with your time variable. See documentation in link [C]
below.


---
[A]  https://lifelines.readthedocs.io/en/latest/jupyter_notebooks/Proportional%20hazard%20assumption.html
[B]  https://lifelines.readthedocs.io/en/latest/jupyter_notebooks/Proportional%20hazard%20assumption.html#Bin-variable-and-stratify-on-it
[C]  https://lifelines.readthedocs.io/en/latest/jupyter_notebooks/Proportional%20hazard%20assumption.html#Introduce-time-varying-covariates
[D]  https://lifelines.readthedocs.io/en/latest/jupyter_notebooks/Proportional%20hazard%20assumption.html#Modify-the-functional-form
[E]  https://lifelines.readthedocs.io/en/latest/jupyter_notebooks/Proportional%20hazard%20assumption.html#Stratification

Iteration 1: norm_delta = 1.48e+00, step_size = 0.9500, log_lik = -3954.61884, newton_decrement = 5.24e+02, seconds_since_start = 0.0
Iteration 2: norm_delta = 2.15e+00, step_size = 0.9500, log_lik = -3295.63272, newton_decrement = 3.41e+02, seconds_since_start = 0.0
Iteration 3: norm_delta = 4.04e+00, step_size = 0.9500, log_lik = -2843.95629, newton_decrement = 3.20e+02, seconds_since_start = 0.0
Iteration 4: norm_delta = 7.60e+00, step_size = 0.9310, log_lik = -2423.50470, newton_decrement = 3.10e+02, seconds_since_start = 0.0
Iteration 5: norm_delta = 9.11e+00, step_size = 0.2281, log_lik = -2296.27607, newton_decrement = 3.02e+02, seconds_since_start = 0.0
Iteration 6: norm_delta = 9.66e+00, step_size = 0.0726, log_lik = -2253.93357, newton_decrement = 2.98e+02, seconds_since_start = 0.0
Iteration 7: norm_delta = 9.84e+00, step_size = 0.0231, log_lik = -2240.28412, newton_decrement = 2.97e+02, seconds_since_start = 0.0
Iteration 8: norm_delta = 9.90e+00, step_size = 0.0074, log_lik = -2235.92120, newton_decrement = 2.97e+02, seconds_since_start = 0.0
Iteration 9: norm_delta = 9.92e+00, step_size = 0.0023, log_lik = -2234.53007, newton_decrement = 2.97e+02, seconds_since_start = 0.0
Iteration 10: norm_delta = 9.93e+00, step_size = 0.0007, log_lik = -2234.08683, newton_decrement = 2.97e+02, seconds_since_start = 0.1
Iteration 11: norm_delta = 9.93e+00, step_size = 0.0002, log_lik = -2233.94565, newton_decrement = 2.96e+02, seconds_since_start = 0.1
Iteration 12: norm_delta = 9.93e+00, step_size = 0.0001, log_lik = -2233.90068, newton_decrement = 2.96e+02, seconds_since_start = 0.1
Iteration 13: norm_delta = 9.93e+00, step_size = 0.0000, log_lik = -2233.88636, newton_decrement = 2.96e+02, seconds_since_start = 0.1
Iteration 14: norm_delta = 9.93e+00, step_size = 0.0000, log_lik = -2233.88179, newton_decrement = 2.96e+02, seconds_since_start = 0.1
Convergence failed. See any warning messages.
Cox模型摘要:
<lifelines.CoxPHFitter: fitted with 769 total observations, 70 right-censored observations>
             duration col = '检测孕周'
                event col = 'Y染色体浓度'
      baseline estimation = breslow
   number of observations = 769
number of events observed = 699
   partial log-likelihood = -2233.88
         time fit was run = 2025-09-07 06:19:06 UTC

---
           coef exp(coef)  se(coef)  coef lower 95%  coef upper 95% exp(coef) lower 95% exp(coef) upper 95%
covariate                                                                                                  
PCA1      -0.03      0.97      0.00           -0.03           -0.03                0.97                0.97
PCA2       0.31      1.37      0.01            0.29            0.34                1.34                1.41
PCA3      -0.19      0.83      0.01           -0.21           -0.16                0.81                0.85
PCA4      -0.17      0.85      0.01           -0.19           -0.14                0.83                0.87

           cmp to      z      p  -log2(p)
covariate                                
PCA1         0.00 -21.11 <0.005    326.04
PCA2         0.00  24.26 <0.005    429.41
PCA3         0.00 -15.51 <0.005    177.79
PCA4         0.00 -14.64 <0.005    158.84
---
Concordance = 1.00
Partial AIC = 4475.76
log-likelihood ratio test = 3441.47 on 4 df
-log2(p) of ll-ratio test = inf


比例风险假设检验:
The ``p_value_threshold`` is set at 0.05. Even under the null hypothesis of no violations, some
covariates will be below the threshold by chance. This is compounded when there are many covariates.
Similarly, when there are lots of observations, even minor deviances from the proportional hazard
assumption will be flagged.

With that in mind, it's best to use a combination of statistical tests and visual tests to determine
the most serious violations. Produce visual plots using ``check_assumptions(..., show_plots=True)``
and looking for non-constant lines. See link [A] below for a full example.

<lifelines.StatisticalResult: proportional_hazard_test>
 null_distribution = chi squared
degrees_of_freedom = 1
             model = <lifelines.CoxPHFitter: fitted with 769 total observations, 70 right-censored observations>
         test_name = proportional_hazard_test

---
           test_statistic      p  -log2(p)
PCA1 km              8.78 <0.005      8.36
     rank            8.24 <0.005      7.93
PCA2 km             13.44 <0.005     11.99
     rank           13.06 <0.005     11.70
PCA3 km              9.43 <0.005      8.87
     rank            9.71 <0.005      9.09
PCA4 km              9.41 <0.005      8.85
     rank            9.56 <0.005      8.97


1. Variable 'PCA1' failed the non-proportional test: p-value is 0.0030.

   Advice 1: the functional form of the variable 'PCA1' might be incorrect. That is, there may be
non-linear terms missing. The proportional hazard test used is very sensitive to incorrect
functional forms. See documentation in link [D] below on how to specify a functional form.

   Advice 2: try binning the variable 'PCA1' using pd.cut, and then specify it in `strata=['PCA1',
...]` in the call in `.fit`. See documentation in link [B] below.

   Advice 3: try adding an interaction term with your time variable. See documentation in link [C]
below.


2. Variable 'PCA2' failed the non-proportional test: p-value is 0.0002.

   Advice 1: the functional form of the variable 'PCA2' might be incorrect. That is, there may be
non-linear terms missing. The proportional hazard test used is very sensitive to incorrect
functional forms. See documentation in link [D] below on how to specify a functional form.

   Advice 2: try binning the variable 'PCA2' using pd.cut, and then specify it in `strata=['PCA2',
...]` in the call in `.fit`. See documentation in link [B] below.

   Advice 3: try adding an interaction term with your time variable. See documentation in link [C]
below.


3. Variable 'PCA3' failed the non-proportional test: p-value is 0.0018.

   Advice 1: the functional form of the variable 'PCA3' might be incorrect. That is, there may be
non-linear terms missing. The proportional hazard test used is very sensitive to incorrect
functional forms. See documentation in link [D] below on how to specify a functional form.

   Advice 2: try binning the variable 'PCA3' using pd.cut, and then specify it in `strata=['PCA3',
...]` in the call in `.fit`. See documentation in link [B] below.

   Advice 3: try adding an interaction term with your time variable. See documentation in link [C]
below.


4. Variable 'PCA4' failed the non-proportional test: p-value is 0.0020.

   Advice 1: the functional form of the variable 'PCA4' might be incorrect. That is, there may be
non-linear terms missing. The proportional hazard test used is very sensitive to incorrect
functional forms. See documentation in link [D] below on how to specify a functional form.

   Advice 2: try binning the variable 'PCA4' using pd.cut, and then specify it in `strata=['PCA4',
...]` in the call in `.fit`. See documentation in link [B] below.

   Advice 3: try adding an interaction term with your time variable. See documentation in link [C]
below.


---
[A]  https://lifelines.readthedocs.io/en/latest/jupyter_notebooks/Proportional%20hazard%20assumption.html
[B]  https://lifelines.readthedocs.io/en/latest/jupyter_notebooks/Proportional%20hazard%20assumption.html#Bin-variable-and-stratify-on-it
[C]  https://lifelines.readthedocs.io/en/latest/jupyter_notebooks/Proportional%20hazard%20assumption.html#Introduce-time-varying-covariates
[D]  https://lifelines.readthedocs.io/en/latest/jupyter_notebooks/Proportional%20hazard%20assumption.html#Modify-the-functional-form
[E]  https://lifelines.readthedocs.io/en/latest/jupyter_notebooks/Proportional%20hazard%20assumption.html#Stratification

最接近的时间点: t = baseline survival    138.0
dtype: float64
最接近的时间点: t = baseline survival    116.0
dtype: float64
警告：发现无法解析的日期，已将其转换为NaT
原始数据类别分布:
染色体的非整倍体
0    537
1     52
2     15
Name: count, dtype: int64

重采样后数据类别分布:
染色体的非整倍体
0    537
1    537
2    537
Name: count, dtype: int64

混淆矩阵:
[[ 96  10   2]
 [  3 104   1]
 [  2   0 105]]

分类报告:
              precision    recall  f1-score   support

           0       0.95      0.89      0.92       108
           1       0.91      0.96      0.94       108
           2       0.97      0.98      0.98       107

    accuracy                           0.94       323
   macro avg       0.94      0.94      0.94       323
weighted avg       0.94      0.94      0.94       323

